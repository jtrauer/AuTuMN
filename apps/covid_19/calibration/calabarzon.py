from autumn.constants import Region
from apps.covid_19.calibration import base
from apps.covid_19.calibration.base import (
    provide_default_calibration_params,
    add_standard_dispersion_parameter,
    add_standard_philippines_params,
    assign_trailing_weights_to_halves,
)
from apps.covid_19.constants import Compartment


def run_calibration_chain(max_seconds: int, run_id: int, num_chains: int):
    base.run_calibration_chain(
        max_seconds,
        run_id,
        num_chains,
        Region.CALABARZON,
        PAR_PRIORS,
        TARGET_OUTPUTS,
        mode="autumn_mcmc",
    )

# START CALIBRATION VALUES
# Notification data:
notification_times = [
68,
69,
70,
71,
72,
73,
74,
75,
76,
77,
78,
79,
80,
81,
82,
83,
84,
85,
86,
87,
88,
89,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99,
100,
101,
102,
103,
104,
105,
106,
107,
108,
109,
110,
111,
112,
113,
114,
115,
116,
117,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
178,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200,
201,
202,
203,
204,
205,
206,
207,
208,
209,
210,
211,
212,
213,
214,
215,
216,
217,
218,
219,
]

notification_values = [
8,
9,
10,
12,
11,
9,
11,
14,
16,
18,
20,
22,
23,
25,
26,
27,
28,
27,
28,
29,
29,
30,
32,
35,
37,
36,
40,
41,
45,
46,
44,
47,
50,
49,
48,
45,
42,
43,
39,
34,
30,
27,
24,
22,
18,
17,
17,
16,
17,
18,
18,
18,
17,
18,
17,
17,
15,
16,
16,
16,
16,
18,
17,
18,
18,
18,
19,
20,
19,
22,
23,
25,
25,
25,
25,
25,
24,
23,
22,
22,
22,
22,
22,
22,
24,
26,
30,
31,
31,
32,
34,
35,
37,
35,
33,
35,
39,
41,
44,
45,
48,
53,
58,
59,
66,
73,
82,
93,
95,
95,
103,
109,
113,
116,
121,
132,
140,
149,
159,
168,
176,
184,
194,
199,
202,
205,
214,
235,
270,
309,
323,
368,
439,
498,
559,
603,
632,
669,
677,
684,
695,
672,
633,
594,
577,
565,
534,
503,
496,
491,
498,
511,
]

# ICU data:
icu_times = [
110,
117,
124,
131,
138,
145,
152,
159,
166,
173,
180,
187,
194,
201,
208,
215,
222,
]

icu_values = [
4,
18,
44,
55,
63,
62,
63,
61,
50,
62,
67,
65,
79,
80,
93,
110,
116,
]

# END CALIBRATION VALUES

TARGET_OUTPUTS = [
    {
        "output_key": "notifications",
        "years": notification_times,
        "values": notification_values,
        "loglikelihood_distri": "negative_binomial",
        "time_weights": assign_trailing_weights_to_halves(5, notification_times),
    },
    {
        "output_key": "icu_occupancy",
        "years": icu_times,
        "values": icu_values,
        "loglikelihood_distri": "negative_binomial",
        "time_weights": list(range(1, len(icu_times) + 1)),
    },
]


PAR_PRIORS = provide_default_calibration_params()
PAR_PRIORS = add_standard_dispersion_parameter(PAR_PRIORS, TARGET_OUTPUTS, "notifications")
PAR_PRIORS = add_standard_dispersion_parameter(PAR_PRIORS, TARGET_OUTPUTS, "icu_occupancy")
PAR_PRIORS = add_standard_philippines_params(PAR_PRIORS)
