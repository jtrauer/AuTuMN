from autumn.constants import Region
from apps.covid_19.calibration import base
from apps.covid_19.calibration.base import (
    provide_default_calibration_params,
    add_standard_dispersion_parameter,
    add_standard_philippines_params,
    assign_trailing_weights_to_halves,
)


def run_calibration_chain(max_seconds: int, run_id: int, num_chains: int):
    base.run_calibration_chain(
        max_seconds,
        run_id,
        num_chains,
        Region.PHILIPPINES,
        PAR_PRIORS,
        TARGET_OUTPUTS,
        mode="autumn_mcmc",
    )

# START CALIBRATION VALUES
# Notification data:
notification_times = [
62,
63,
64,
65,
66,
67,
68,
69,
70,
71,
72,
73,
74,
75,
76,
77,
78,
79,
80,
81,
82,
83,
84,
85,
86,
87,
88,
89,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99,
100,
101,
102,
103,
104,
105,
106,
107,
108,
109,
110,
111,
112,
113,
114,
115,
116,
117,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
178,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200,
201,
202,
203,
204,
205,
206,
207,
208,
209,
210,
211,
212,
213,
214,
215,
216,
217,
218,
219,
]

notification_values = [
14,
17,
26,
45,
59,
61,
65,
73,
81,
87,
87,
93,
105,
120,
132,
147,
156,
158,
165,
180,
187,
196,
200,
207,
209,
206,
202,
205,
212,
215,
210,
212,
226,
237,
253,
260,
271,
286,
294,
294,
290,
282,
271,
258,
247,
241,
247,
250,
242,
237,
246,
255,
252,
254,
264,
277,
328,
335,
332,
335,
341,
350,
361,
340,
347,
348,
349,
344,
333,
322,
313,
310,
317,
323,
325,
342,
366,
382,
389,
400,
417,
417,
413,
419,
423,
433,
423,
410,
418,
422,
429,
459,
499,
519,
521,
550,
590,
602,
615,
590,
581,
600,
604,
604,
632,
655,
686,
735,
770,
798,
844,
901,
963,
1058,
1095,
1123,
1245,
1392,
1509,
1588,
1656,
1752,
1807,
1841,
1873,
1881,
1936,
1990,
2028,
2066,
2076,
2094,
2183,
2258,
2348,
2453,
2474,
2552,
2728,
2860,
3001,
3112,
3180,
3260,
3345,
3388,
3401,
3382,
3290,
3179,
3180,
3135,
3041,
2966,
2877,
2854,
2877,
2890,
]

# ICU data:
icu_times = [
110,
117,
124,
131,
138,
145,
152,
159,
166,
173,
180,
187,
194,
201,
208,
215,
222,
]

icu_values = [
153,
371,
477,
525,
487,
454,
460,
463,
419,
450,
489,
505,
580,
653,
703,
759,
786,
]

# END CALIBRATION VALUES

TARGET_OUTPUTS = [
    {
        "output_key": "notifications",
        "years": notification_times,
        "values": notification_values,
        "loglikelihood_distri": "normal",
        # "time_weights": assign_trailing_weights_to_halves(5, notification_times),
    },
    # {
    #     "output_key": "icu_occupancy",
    #     "years": icu_times,
    #     "values": icu_values,
    #     "loglikelihood_distri": "negative_binomial",
    #     "time_weights": list(range(1, len(icu_times) + 1)),
    # },
]

PAR_PRIORS = provide_default_calibration_params()
PAR_PRIORS = add_standard_dispersion_parameter(PAR_PRIORS, TARGET_OUTPUTS, "notifications")
# PAR_PRIORS = add_standard_dispersion_parameter(PAR_PRIORS, TARGET_OUTPUTS, "icu_occupancy")
PAR_PRIORS = add_standard_philippines_params(PAR_PRIORS)
